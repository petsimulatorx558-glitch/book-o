repeat wait() until game and game.Players and game.Players.LocalPlayer and game.Players.LocalPlayer:FindFirstChild("PlayerGui")
local player = game.Players.LocalPlayer
local pgui = player.PlayerGui

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "BookOMenu"
screenGui.Parent = pgui
screenGui.IgnoreGuiInset = true

local sidebar = Instance.new("Frame")
sidebar.Size = UDim2.new(0,96,1,0)
sidebar.BackgroundColor3=Color3.fromRGB(60,60,110)
sidebar.Parent=screenGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0,330,0,430)
mainFrame.Position = UDim2.new(0.5,-165,0.5,-215)
mainFrame.BackgroundColor3=Color3.fromRGB(34,34,38)
mainFrame.Visible=true
mainFrame.Parent=screenGui

local titleBar=Instance.new("Frame")
titleBar.Size=UDim2.new(1,0,0,52)
titleBar.BackgroundColor3=Color3.fromRGB(25,25,50)
titleBar.Parent=mainFrame

local titleLabel=Instance.new("TextLabel")
titleLabel.Size=UDim2.new(1,-50,1,0)
titleLabel.Position=UDim2.new(0,14,0,0)
titleLabel.Text="Book-O Menu"
titleLabel.BackgroundTransparency=1
titleLabel.TextColor3=Color3.fromRGB(170,180,255)
titleLabel.Font=Enum.Font.GothamBold
titleLabel.TextSize=29
titleLabel.TextXAlignment=Enum.TextXAlignment.Left
titleLabel.Parent=titleBar

-- Simple drag (PC only)
local UIS = game:GetService("UserInputService")
local dragging, dragInput, dragStart, startPos
titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        dragInput = input
    end
end)
UIS.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale,startPos.X.Offset+delta.X,startPos.Y.Scale,startPos.Y.Offset+delta.Y)
    end
end)
UIS.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

-- Category buttons
local categories = {"Home","ESP","Aim","About"}
local categoryFrames = {}
for i,cat in pairs(categories) do
    local btn=Instance.new("TextButton")
    btn.Size=UDim2.new(0,80,0,48)
    btn.Position=UDim2.new(0,8,0,60*i)
    btn.Text=cat
    btn.Parent=sidebar
    local frame=Instance.new("Frame")
    frame.Name=cat.."Frame"
    frame.Size=UDim2.new(1,-92,1,-70)
    frame.Position=UDim2.new(0,86,0,52)
    frame.Visible=(i==1)
    frame.BackgroundTransparency=1
    frame.Parent=mainFrame
    categoryFrames[i]=frame
    btn.MouseButton1Click:Connect(function()
        for k,frame in pairs(categoryFrames) do frame.Visible=false end
        frame.Visible=true
    end)
end

-- Home frame
local homeText=Instance.new("TextLabel")
homeText.Size=UDim2.new(1,-24,0,60)
homeText.Position=UDim2.new(0,12,0,21)
homeText.Text="Welcome to Book-O!\nChoose a feature"
homeText.Font=Enum.Font.GothamSemibold
homeText.TextSize=24
homeText.TextColor3=Color3.fromRGB(170,220,255)
homeText.BackgroundTransparency=1
homeText.Parent=categoryFrames[1]

-- ESP frame
local espToggle=Instance.new("TextButton")
espToggle.Size=UDim2.new(0,214,0,48)
espToggle.Position=UDim2.new(0,33,0,37)
espToggle.Text="Toggle ESP\n(Murderer/Sheriff)"
espToggle.Font=Enum.Font.Gotham
espToggle.TextScaled=true
espToggle.BackgroundColor3=Color3.fromRGB(60,80,130)
espToggle.TextColor3=Color3.fromRGB(255,255,255)
espToggle.Parent=categoryFrames[2]

-- Aim frame
local aimMurdererBtn=Instance.new("TextButton")
aimMurdererBtn.Size=UDim2.new(0,181,0,41)
aimMurdererBtn.Position=UDim2.new(0,46,0,41)
aimMurdererBtn.Text="Auto Aim: Murderer"
aimMurdererBtn.Font=Enum.Font.GothamSemibold
aimMurdererBtn.TextScaled=true
aimMurdererBtn.BackgroundColor3=Color3.fromRGB(255,60,80)
aimMurdererBtn.TextColor3=Color3.fromRGB(255,255,255)
aimMurdererBtn.Parent=categoryFrames[3]

local aimSheriffBtn=Instance.new("TextButton")
aimSheriffBtn.Size=UDim2.new(0,181,0,41)
aimSheriffBtn.Position=UDim2.new(0,46,0,98)
aimSheriffBtn.Text="Auto Aim: Sheriff"
aimSheriffBtn.Font=Enum.Font.GothamSemibold
aimSheriffBtn.TextScaled=true
aimSheriffBtn.BackgroundColor3=Color3.fromRGB(68,68,210)
aimSheriffBtn.TextColor3=Color3.fromRGB(255,255,255)
aimSheriffBtn.Parent=categoryFrames[3]

-- About frame
local aboutText=Instance.new("TextLabel")
aboutText.Size=UDim2.new(1,-24,0,34)
aboutText.Position=UDim2.new(0,12,0,24)
aboutText.Text="Book-O Menu by petsimulatorx558-glitch"
aboutText.TextColor3=Color3.fromRGB(220,220,255)
aboutText.Font=Enum.Font.Gotham
aboutText.TextSize=19
aboutText.BackgroundTransparency=1
aboutText.Parent=categoryFrames[4]

local aboutDesc=Instance.new("TextLabel")
aboutDesc.Size=UDim2.new(1,-24,0,52)
aboutDesc.Position=UDim2.new(0,12,0,62)
aboutDesc.Text="Mobile-friendly | ESP | Auto Aim"
aboutDesc.TextColor3=Color3.fromRGB(190,190,230)
aboutDesc.Font=Enum.Font.GothamLight
aboutDesc.TextSize=15
aboutDesc.BackgroundTransparency=1
aboutDesc.TextWrapped=true
aboutDesc.Parent=categoryFrames[4]

-- ESP logic
local function findMurderer()
    for _,plr in ipairs(game.Players:GetPlayers())do
        if plr:FindFirstChild("Backpack")and plr.Backpack:FindFirstChild("Knife")then return plr end
        if plr.Character and plr.Character:FindFirstChild("Knife") then return plr end
    end
end

local function findSheriff()
    for _,plr in ipairs(game.Players:GetPlayers())do
        if plr:FindFirstChild("Backpack")and plr.Backpack:FindFirstChild("Gun")then return plr end
        if plr.Character and plr.Character:FindFirstChild("Gun")then return plr end
    end
end

local function clearESP()
    for _,plr in pairs(game.Players:GetPlayers())do
        if plr.Character then
            for _,obj in ipairs(plr.Character:GetDescendants())do
                if obj:IsA("BoxHandleAdornment")then obj:Destroy()end
            end
        end
    end
end

local function addESPToPlayer(player, color)
    if not player or not player.Character then return end
    for _,part in ipairs(player.Character:GetDescendants())do
        if (part:IsA("Part") or part:IsA("MeshPart"))then
            for _,adorn in ipairs(part:GetChildren())do
                if adorn:IsA("BoxHandleAdornment")then adorn:Destroy()end
            end
            local espBox=Instance.new("BoxHandleAdornment")
            espBox.Parent=part
            espBox.Adornee=part
            espBox.AlwaysOnTop=true
            espBox.Transparency=0.7
            espBox.Size=part.Size
            espBox.Color3=color
            espBox.ZIndex=0
        end
    end
end

local espEnabled=false
local function applyESP()
    clearESP()
    if not espEnabled then return end
    local murderer=findMurderer()
    local sheriff=findSheriff()
    if murderer then addESPToPlayer(murderer,Color3.fromRGB(255,0,70))end
    if sheriff then addESPToPlayer(sheriff,Color3.fromRGB(30,30,255))end
end

game.Players.PlayerAdded:Connect(function(plr)
    plr.CharacterAdded:Connect(applyESP)
end)
for _,plr in pairs(game.Players:GetPlayers())do
    plr.CharacterAdded:Connect(applyESP)
end

espToggle.MouseButton1Click:Connect(function()
    espEnabled=not espEnabled
    applyESP()
end)

-- Auto Aim
local function aimAtPlayer(player)
    if not player or not player.Character or not player.Character:FindFirstChild("Head")then return end
    local cam=workspace.CurrentCamera
    local head=player.Character:FindFirstChild("Head")
    if not cam or not head then return end
    cam.CameraSubject=head
    cam.CFrame=CFrame.new(cam.CFrame.Position,head.Position)
end

aimMurdererBtn.MouseButton1Click:Connect(function() aimAtPlayer(findMurderer()) end)
aimSheriffBtn.MouseButton1Click:Connect(function() aimAtPlayer(findSheriff()) end)

-- Ensure GUI is shown on load
mainFrame.Visible=true
