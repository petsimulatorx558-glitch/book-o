-- Book-O Menu Delta Executor Edition
-- Clean, mobile-friendly, and robust!

local player = game:GetService("Players").LocalPlayer
local pgui = player:WaitForChild("PlayerGui")

-- Remove previous menu if any
local oldMenu = pgui:FindFirstChild("BookOMenu")
if oldMenu then oldMenu:Destroy() end

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "BookOMenu"
screenGui.Parent = pgui
screenGui.IgnoreGuiInset = true
screenGui.ResetOnSpawn = false

local sidebar = Instance.new("Frame")
sidebar.Size = UDim2.new(0, 96, 1, 0)
sidebar.BackgroundColor3 = Color3.fromRGB(48, 48, 84)
sidebar.BorderSizePixel = 0
sidebar.Parent = screenGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 330, 0, 430)
mainFrame.Position = UDim2.new(0.5, -165, 0.5, -215)
mainFrame.BackgroundColor3 = Color3.fromRGB(28, 28, 32)
mainFrame.BorderSizePixel = 0
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.Visible = true
mainFrame.Parent = screenGui
mainFrame.ClipsDescendants = true

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 52)
titleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 65)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -52, 1, 0)
titleLabel.Position = UDim2.new(0, 16, 0, 0)
titleLabel.Text = "üìñ Book-O Menu"
titleLabel.BackgroundTransparency = 1
titleLabel.TextColor3 = Color3.fromRGB(200, 215, 250)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 30
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 42, 1, 0)
closeBtn.Position = UDim2.new(1, -42, 0, 0)
closeBtn.Text = "√ó"
closeBtn.BackgroundTransparency = 1
closeBtn.TextColor3 = Color3.fromRGB(220, 90, 90)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 28
closeBtn.Parent = titleBar
closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Mobile+PC Drag
local UIS = game:GetService("UserInputService")
local dragging, dragInput, dragStart, startPos
titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging, dragInput, dragStart, startPos = true, input, input.Position, mainFrame.Position
        input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
    end
end)
UIS.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Sidebar Categories
local categories = {"Home","ESP","Aim","About"}
local icons = {"üè†","üëÅÔ∏è","üéØ","‚ÑπÔ∏è"}
local categoryFrames = {}

for i,cat in pairs(categories) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 80, 0, 48)
    btn.Position = UDim2.new(0, 8, 0, 60*i)
    btn.Text = icons[i].." "..cat
    btn.BackgroundColor3 = (i==1) and Color3.fromRGB(85,116,225) or Color3.fromRGB(60,60,95)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 19
    btn.BorderSizePixel = 0
    btn.AutoButtonColor = false
    btn.Parent = sidebar

    local frame = Instance.new("Frame")
    frame.Name = cat.."Frame"
    frame.Size = UDim2.new(1,-92,1,-70)
    frame.Position = UDim2.new(0,86,0,52)
    frame.Visible = (i == 1)
    frame.BackgroundTransparency = 1
    frame.Parent = mainFrame
    categoryFrames[i] = frame

    btn.MouseButton1Click:Connect(function()
        for k,frame in ipairs(categoryFrames) do 
            frame.Visible = false
            sidebar:GetChildren()[k].BackgroundColor3 = Color3.fromRGB(60,60,95)
        end
        frame.Visible = true
        btn.BackgroundColor3 = Color3.fromRGB(85,116,225)
    end)
end

-- Home frame
local homeText = Instance.new("TextLabel")
homeText.Size = UDim2.new(1, -24, 0, 80)
homeText.Position = UDim2.new(0, 12, 0, 30)
homeText.Text = "üéâ Welcome to Book-O!\nSelect a feature on the left."
homeText.Font = Enum.Font.GothamSemibold
homeText.TextSize = 23
homeText.TextColor3 = Color3.fromRGB(180,240,255)
homeText.BackgroundTransparency = 1
homeText.TextWrapped = true
homeText.Parent = categoryFrames[1]

-- ESP frame
local espToggle = Instance.new("TextButton")
espToggle.Size = UDim2.new(0, 210, 0, 54)
espToggle.Position = UDim2.new(0, 36, 0, 48)
espToggle.Text = "üëÅÔ∏è Toggle ESP\n(Murderer/Sheriff)"
espToggle.Font = Enum.Font.Gotham
espToggle.TextSize = 20
espToggle.BackgroundColor3 = Color3.fromRGB(60, 140, 200)
espToggle.TextColor3 = Color3.fromRGB(245,255,255)
espToggle.BorderSizePixel = 0
espToggle.Parent = categoryFrames[2]

-- Aim frame
local aimMurdererBtn = Instance.new("TextButton")
aimMurdererBtn.Size = UDim2.new(0,181,0,48)
aimMurdererBtn.Position = UDim2.new(0,46,0,41)
aimMurdererBtn.Text = "üéØ Auto Aim: Murderer"
aimMurdererBtn.Font = Enum.Font.GothamSemibold
aimMurdererBtn.TextScaled = true
aimMurdererBtn.BackgroundColor3 = Color3.fromRGB(220,60,80)
aimMurdererBtn.TextColor3 = Color3.fromRGB(255,255,255)
aimMurdererBtn.BorderSizePixel = 0
aimMurdererBtn.Parent = categoryFrames[3]

local aimSheriffBtn = Instance.new("TextButton")
aimSheriffBtn.Size = UDim2.new(0,181,0,48)
aimSheriffBtn.Position = UDim2.new(0,46,0,100)
aimSheriffBtn.Text = "üéØ Auto Aim: Sheriff"
aimSheriffBtn.Font = Enum.Font.GothamSemibold
aimSheriffBtn.TextScaled = true
aimSheriffBtn.BackgroundColor3 = Color3.fromRGB(68,140,225)
aimSheriffBtn.TextColor3 = Color3.fromRGB(255,255,255)
aimSheriffBtn.BorderSizePixel = 0
aimSheriffBtn.Parent = categoryFrames[3]

-- About frame
local aboutText = Instance.new("TextLabel")
aboutText.Size = UDim2.new(1, -24, 0, 34)
aboutText.Position = UDim2.new(0, 12, 0, 18)
aboutText.Text = "Book-O Menu by petsimulatorx558-glitch"
aboutText.TextColor3 = Color3.fromRGB(210,210,255)
aboutText.Font = Enum.Font.Gotham
aboutText.TextSize = 18
aboutText.BackgroundTransparency = 1
aboutText.Parent = categoryFrames[4]

local aboutDesc = Instance.new("TextLabel")
aboutDesc.Size = UDim2.new(1, -24, 0, 49)
aboutDesc.Position = UDim2.new(0, 12, 0, 52)
aboutDesc.Text = "Mobile friendly | ESP | Auto Aim | Executor safe"
aboutDesc.TextColor3 = Color3.fromRGB(180,190,230)
aboutDesc.Font = Enum.Font.GothamLight
aboutDesc.TextSize = 16
aboutDesc.BackgroundTransparency = 1
aboutDesc.TextWrapped = true
aboutDesc.Parent = categoryFrames[4]

-- ESP logic
local function findMurderer()
    for _,plr in ipairs(game.Players:GetPlayers()) do
        if plr:FindFirstChild("Backpack") and plr.Backpack:FindFirstChild("Knife") then return plr end
        if plr.Character and plr.Character:FindFirstChild("Knife") then return plr end
    end
end

local function findSheriff()
    for _,plr in ipairs(game.Players:GetPlayers()) do
        if plr:FindFirstChild("Backpack") and plr.Backpack:FindFirstChild("Gun") then return plr end
        if plr.Character and plr.Character:FindFirstChild("Gun") then return plr end
    end
end

local function clearESP()
    for _,plr in pairs(game.Players:GetPlayers()) do
        if plr.Character then
            for _,obj in ipairs(plr.Character:GetDescendants()) do
                if obj:IsA("BoxHandleAdornment") then obj:Destroy() end
            end
        end
    end
end

local function addESPToPlayer(player, color)
    if not player or not player.Character then return end
    for _,part in ipairs(player.Character:GetDescendants()) do
        if part:IsA("BasePart") then
            for _,adorn in ipairs(part:GetChildren()) do
                if adorn:IsA("BoxHandleAdornment") then adorn:Destroy() end
            end
            local espBox = Instance.new("BoxHandleAdornment")
            espBox.Parent = part
            espBox.Adornee = part
            espBox.AlwaysOnTop = true
            espBox.Transparency = 0.6
            espBox.Size = part.Size
            espBox.Color3 = color
            espBox.ZIndex = 0
        end
    end
end

local espEnabled = false
local function applyESP()
    clearESP()
    if not espEnabled then return end
    local murderer = findMurderer()
    local sheriff = findSheriff()
    if murderer then addESPToPlayer(murderer, Color3.fromRGB(255, 60, 120)) end
    if sheriff then addESPToPlayer(sheriff, Color3.fromRGB(50, 130, 255)) end
end

game.Players.PlayerAdded:Connect(function(plr)
    plr.CharacterAdded:Connect(applyESP)
end)
for _,plr in pairs(game.Players:GetPlayers()) do
    plr.CharacterAdded:Connect(applyESP)
end

espToggle.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    espToggle.BackgroundColor3 = espEnabled and Color3.fromRGB(50,180,140) or Color3.fromRGB(60,140,200)
    applyESP()
end)

-- Auto Aim
local function aimAtPlayer(player)
    if not player or not player.Character or not player.Character:FindFirstChild("Head") then return end
    local cam = workspace.CurrentCamera
    local head = player.Character:FindFirstChild("Head")
    cam.CameraSubject = head
    cam.CFrame = CFrame.new(cam.CFrame.Position, head.Position)
end
aimMurdererBtn.MouseButton1Click:Connect(function() aimAtPlayer(findMurderer()) end)
aimSheriffBtn.MouseButton1Click:Connect(function() aimAtPlayer(findSheriff()) end)

mainFrame.Visible = true
